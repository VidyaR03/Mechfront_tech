{% extends 'dashboard/base_template.html' %}
{% block custom_css %}
{% block page_title %}
{% endblock page_title %}
<style>
    .custom-error {
        max-width: 300px;
        /* Adjust the width to your desired value */
        margin: 0 auto;
        /* Add this line to center the element */
        text-align: center;
        /* Add this line to center the text inside the element */
    }

    .input-group-text {
        cursor: pointer;
    }

    .grey-card {
        background-color: LightGray;
    }

    .negative-padding {
        margin-top: -60px;
    }
</style>
{% endblock custom_css %}
<!-- Main content -->
{% block main_content %}
<div class="page-wrapper" style="min-height: 468px;">
    <div class="content container-fluid">
        <div class="page-header">
            <div class="row">
                <div class="col">
                    <h3 class="page-title"> <a href="{% url 'inventory_list_data' %}" style="margin-right: 10px;"><i
                                class="fa fa-arrow-left" data-bs-toggle="tooltip" title="" data-bs-original-title="Back"
                                aria-label="fa fa-arrow-left"></i></a>
                        Edit Inventory</h3>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="card" data-select2-id="9">
                    <div class="card-body" data-select2-id="8">
                        <form method="post" id="inventory_form" action="#" enctype="multipart/form-data"
                            autocomplete="off" novalidate="novalidate">
                            {% csrf_token %}
                            <input type="hidden" name="inventory_id" id="inventory_id" value="{{inventory_item.id}}">
                            <div class="row" data-select2-id="6">
                                <div class="col-md-6">
                                    <div class="form-group">
                                        <label style="color:black">Name</label>
                                        <div>
                                            <input class="form-control" type="text" name="inventory_name" id="name"
                                                value="{{inventory_item.inventory_name}}">
                                        </div>
                                    </div>
                                </div>
                                <div class=" col-md-3">
                                    <div class="form-group">
                                        <label style="color:black">Item Code</label>
                                        <div>
                                            <input class="form-control" type="text" name="item_code" id="item_code"
                                                value="{{inventory_item.item_code}}">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                       <label>Unit</label>
                                       <select class="form-control" name="unit" id="unit">
                                           <option value="{{inventory_item.units}}" >{{inventory_item.units}}</option>
                                           <option value="kg">Kilogram (kg)</option>
                                           <option value="g">Gram (g)</option>
                                           <option value="mg">Milligram (mg)</option>
                                           <option value="ltr">Litre (L)</option>
                                           <option value="ml">Millilitre (mL)</option>
                                           <option value="m">Meter (m)</option>
                                           <option value="cm">Centimeter (cm)</option>
                                           <option value="mm">Millimeter (mm)</option>
                                           <option value="km">Kilometer (km)</option>
                                           <option value="sq_m">Square Meter (m²)</option>
                                           <option value="sq_km">Square Kilometer (km²)</option>
                                           <option value="cubic_m">Cubic Meter (m³)</option>
                                           <option value="cubic_cm">Cubic Centimeter (cm³)</option>
                                           <option value="in">Inch (in)</option>
                                           <option value="ft">Foot (ft)</option>
                                           <option value="yd">Yard (yd)</option>
                                           <option value="mile">Mile (mi)</option>
                                           <option value="oz">Ounce (oz)</option>
                                           <option value="lb">Pound (lb)</option>
                                           <option value="ton">Ton (t)</option>
                                           <option value="gal">Gallon (gal)</option>
                                           <option value="qt">Quart (qt)</option>
                                           <option value="pt">Pint (pt)</option>
                                           <option value="cup">Cup</option>
                                           <option value="tbsp">Tablespoon (tbsp)</option>
                                           <option value="tsp">Teaspoon (tsp)</option>
                                           <option value="other">Other</option>
                                       </select>
                                   </div>
                                </div>         
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label style="color:black"> Type</label>
                                        <select class="form-select" name="good_type" id="good_type">
                                            <option value="{{inventory_item.type}}">{{inventory_item.type}}</option>
                                            <option value="Goods">Goods</option>
                                            <option value="Service">Service</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-group">
                                        <label style="color:black">Tax Type</label>
                                        <div>
                                            <select class="form-select" name="tax_type" id="tax_type">
                                                <option value="{{inventory_item.tax_type}}">{{inventory_item.tax_type}}</option>
                                                <!-- <option value="Nil Rated" >Nil Rated</option> -->

                                                <option value="Non GST" >Non GST</option>

                                                <option value="Taxable">Taxable</option>

                                                <!-- <option value="Out of Scope" >Out of Scope</option> -->
                                            </select>
                                        </div>
                                    </div>
                                </div>
                
                                <div class="col-lg-10 pt11">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label>HSN </label>
                                                <div>
                                                    <input class="form-control " type="text" name="hsn" id="hsn"
                                                        value="{{inventory_item.hsn}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label>SKU</label>
                                                <div>
                                                    <input class="form-control " type="text" name="sku" id="sku"
                                                        value="{{inventory_item.sku}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label>Default Discount (%)
                                                </label>
                                                <div>
                                                    <input class="form-control " type="text" name="default_discount"
                                                        id="default_discount" value="{{inventory_item.default_discount}}">
                                                </div>
                                            </div>
                                        </div>
                                     
                                    </div>
                                </div>
                                <hr>
                                <div class="col-lg-2 pt11">
                                    <h5>
                                        <input type="checkbox" name="sales_information" id="sales_information"
                                            value="sales_information" style="vertical-align: middle;" checked=""> Sales
                                        Information
                                        <!-- <input type="checkbox" name="sales_information" id="sales_information" value="sales_information" style="vertical-align: middle;"> Sales Information  -->
                                    </h5>
                                </div>
                                <div class="col-md-2 pt11">
                                    <div class="form-group">
                                        <label style="color:black">Rate</label>
                                        <div>
                                            <input class="form-control" type="text" name="sale_rate" id="sale_rate"
                                                value="{{inventory_item.sales_rate}}">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 pt11">
                                    <div class="form-group">
                                        <label style="color:black">Sales</label>
                                        <div>
                                            <select class="select select2-hidden-accessible" name="sales_account"
                                                id="sales_account" data-select2-id="sales_account" tabindex="-1"
                                                aria-hidden="true">
                                                <option value="">{{inventory_item.sales}}</option>
                                                <optgroup label="Income">
                                                    <option value="Sales" selected="" data-select2-id="2">
                                                        Sales</option>
                                                    <option value="Discount">Discount</option>
                                                    <option value="Shipping Charge">Shipping Charge</option>
                                                    <option value="General Income">General Income</option>
                                                    <option value="Late Fee Income">Late Fee Income</option>
                                                    <option value="Interest Income">Other Charges</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 pt11">
                                    <div class="form-group">
                                        <label>Descirption </label>
                                        <div>
                                            <textarea class="form-control" name="sale_description"
                                                id="sale_description" value="">{{inventory_item.sales_information_description}}</textarea>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="col-lg-2 pt11">
                                    <h5>
                                        <input type="checkbox" style="vertical-align: middle;"
                                            name="purchase_information" id="purchase_information"
                                            value="purchase_information" checked=""> Purchase
                                        Information
                                        <!-- <input type="checkbox" style="vertical-align: middle;" name="purchase_information" id="purchase_information" value="purchase_information"> Purchase Information -->
                                    </h5>
                                </div>
                                <div class="col-md-2 pt11">
                                    <div class="form-group">
                                        <label style="color:black">Rate</label>
                                        <div>
                                            <input class="form-control" type="text" name="purchase_rate"
                                                id="purchase_rate" value="{{inventory_item.purchase_rate}}">
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 pt11">
                                    <div class="form-group">
                                        <label>Purchase</label>
                                        <div>
                                            <select class="select select2-hidden-accessible" name="purchase_account"
                                                id="purchase_account" data-select2-id="purchase_account" tabindex="-1"
                                                aria-hidden="true">
                                                <optgroup label="Cost Of Goods Sold">
                                                    <option value="Purchase A/c" selected="" data-select2-id="4">
                                                        Purchase A/c</option>
                                                    <!-- <option value="Cost of Goods Sold" >Cost of Goods Sold</option>
                                  <option value="Cost of Goods Manufactured" >Cost of Goods Manufactured</option> -->
                                                </optgroup>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 pt11">
                                    <div class="form-group">
                                        <label>Descirption </label>
                                        <div>
                                            <textarea class="form-control" name="purchase_description"
                                                id="purchase_description">{{inventory_item.purchase_information_description}}</textarea>
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <div class="col-lg-2 pt11">
                                    <h5>
                                        <input type="checkbox" style="vertical-align: middle;" name="trackable_item"
                                            id="trackable_item" value="trackable_item" checked=""> Its trackable item
                                        <!-- <input type="checkbox" style="vertical-align: middle;" name="trackable_item" id="trackable_item" value="trackable_item"> Its trackable item -->
                                    </h5>
                                </div>
                                <div class="col-lg-9 pt11">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label style="color:black">Opening Stock {Qty.}</label>
                                                <div>
                                                    <input class="form-control" type="text" name="opening_stock"
                                                        id="opening_stock" value="{{inventory_item.opening_stock_quantity}}">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label style="color:black">Opening Rate</label>
                                                <div>
                                                    <input class="form-control" type="text" name="opening_rate"
                                                        id="opening_rate" value="{{inventory_item.opening_rate}}">
                                                </div>
                                            </div>
                                        </div>
                                       
                                        <div class="col-md-3">
                                            <div class="form-group">
                                                <label>Godown</label>
                                                <div>
                                                    <select class="form-select" name="godown" id="godown">
                                                        <option value="{{inventory_item.godown}}">{{inventory_item.godown}}</option>
                                                        {% for i in godown_name %}
                                                        <option value="{{i.city_name}}">{{i.city_name}}</option>
                                                        {% endfor %}                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row col-sm-6 p-5">
                                    <div class="success_message row"></div>
                                </div>
                                <div class="text-end mt-4">
                                    <button type="submit" class="btn btn-primary" id="btn_submit"
                                        name="btn_submit">Save</button>
                                    <a href="{% url 'inventory_list_data' %}"
                                        class="btn btn-primary">Cancel</a>
                                </div>

                            </div>
                        </form>
                    </div>
                </div>
            </div>
        

            <script type="text/javascript">
                $(function () {
                    $('#inventory_form').validate({

                        rules: {
                            "name": {
                                required: true
                            },
                            "unit": {
                                required: true
                            },
                            "tax_type": {
                                required: true
                            },
                            /*"hsn": {
                                required: true
                            },*/
                            /*"sale_rate": {
                                required: true
                            },*/
                            "sales_account": {
                                required: true
                            },
                            /*"purchase_rate": {
                               required: true
                           },*/
                            "purchase_account": {
                                required: true
                            }
                        },
                        messages: {
                            "name": {
                                required: 'Name is required'
                            },
                            "unit": {
                                required: 'Unit is required'
                            },
                            "tax_type": {
                                required: 'Tax Type is required'
                            },
                            /*"hsn": {
                                required: 'HSN is required'
                            },*/
                            /*"sale_rate": {
                                required: 'Sales Rate is required'
                            },*/
                            "sales_account": {
                                required: 'Sales Account is required'
                            },
                            /*"purchase_rate": {
                                required: 'Purchase Rate is required'
                            },*/
                            "purchase_account": {
                                required: 'Purchase Rate is required'
                            }
                        }
                    });

                    $("#inventory_form").ajaxForm({
                        beforeSend: function () {
                            $('#btn_submit').prop('disabled', true);
                            $('.form_error_msg').html('');
                            $('.success_message').html('<br><div class="alert alert-info">Data analyzing...please wait...</div>');
                        },
                        uploadProgress: function (event, position, total, percentComplete) {
                            //albumprogressbar.width(percentComplete + '%');
                        },
                        beforeSubmit: function () {
                            return $("#inventory_form").valid(); // TRUE when form is valid, FALSE will cancel submit
                        },
                        complete: function (response) {
                            //alert('Your Proposal Id Is'+response.pi);
                            //console.log(response);return;
                            var temp = JSON.parse(response.responseText);
                            //console.log(temp);
                            if (temp.status == 'success') {
                                $('.success_message').show().html(temp.message);
                                setTimeout(function () {
                                    window.location.href = temp.redirect;
                                }, 3000);
                            }
                            else if (temp.status == 'error') {
                                $('#btn_submit').prop('disabled', false);
                                $('.success_message').html('');
                                $.each(temp.errors, function (key, val) {
                                    $('.' + key).html(val);
                                });
                            }
                        }
                    });

                    $tax_type = $('#tax_type').val();

                    if ($tax_type == 'Taxable') {
                        $('.instrastate_gst').show();
                        $('.insterstate_gst').show();
                    }
                    else if ($tax_type == 'Non GST'){
                        $('.instrastate_gst').hide();
                        $('.insterstate_gst').hide();
                    }
                    else {
                        $('.instrastate_gst').hide();
                        $('.insterstate_gst').hide();
                    }
                });
                
            </script>

            <script type="text/javascript">
                $('#tax_type').change(function () {
                    $tax_type = $('#tax_type').val();

                    if ($tax_type == 'Taxable') {
                        $('.instrastate_gst').show();
                        $('.insterstate_gst').show();
                    }
                    else {
                        $('.instrastate_gst').hide();
                        $('.insterstate_gst').hide();
                    }
                });
            </script>

            <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.17.0/jquery.validate.js"></script>

            <script src="https://olatechs.in/crm/supreeno/assets/js/malsup-jquery.js"></script>


        </div>
    </div>
</div>
{% endblock main_content %}