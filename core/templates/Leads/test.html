{% extends 'dashboard/base_template.html' %}
{% block title %}
CRM
{% endblock %}

{% block custom_css %}

<style>
/* Inactive tab styles */
.nav-tabs.nav-tabs-bottom .nav-item .nav-link {
color: #ccc;
/* Faint gray color for inactive tabs */
}

/* Active tab style */
.nav-tabs.nav-tabs-bottom .nav-item .nav-link.active {
color: #000;
/* Black color for active tab */
}
</style>
{% endblock custom_css %}

{% block main_content %}


<div class="page-wrapper" style="padding-top: 0px;">
<div class="content container-fluid">
<div class="page-header">
<div class="row">
<div class="col-sm-12">
<h3 class="page-title">
    <a href="{% url 'lead_list' %}" style="margin-right: 10px;">
        <i class="fa fa-arrow-left" data-bs-toggle="tooltip" title="" data-bs-original-title="Back"
            aria-label="fa fa-arrow-left"></i>
    </a>
    Add Leads
</h3>
</div>
</div>
</div>
<form method="POST" enctype="multipart/form-data" onsubmit="return validateForm(event)">
{% csrf_token %}
<div class="row">
<div class="col-md-12">
<div class="card">
    <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" class="form-control" name="company_name"
                            id="company_name" placeholder="Company Name">
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Service Type</label>
                        <select class="form-control" name="leads_ser_type" id="leads_ser_type"
                            >

                            <option value="" disabled hidden>Select..</option>

                            <option value="Manufacturing" selected>MANUFACTURING</option>

                            <option value="Lab">LAB </option>

                        </select>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Contact Person </label>
                        <input type="text" class="form-control" name="contact_person"
                            id="contact_person" placeholder="Contact Person">
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Contact Number </label>
                        <input type="text" class="form-control" name="contact_number"
                            id="contact_number" placeholder="Contact Number"
                            pattern="\d{10}" title="Enter a 10-digit number">
                    </div>
                </div>


                <div class="col-md-3">
                    <div class="form-group">
                    <label>Date:</label>
                    <input type="date" class="form-control" id="date" name="date_lead">
                  </div>
                  </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label>Address</label>
                        <textarea class="form-control" name="address" placeholder="Enter Address" id="address">NA</textarea>
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label>Email ID</label>
                            <input type="text" class="form-control" name="email" id="email"
                            placeholder="Email Address" onchange="validateEmail(this);" value="NA" title="Please enter a valid email address"/>
                    </div>
                    <p id="msg_email" style="color: red;"></p>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label>Status</label>:
                        <select class="form-control " name="status">
                            <option value="" disabled selected hidden>Select Status</option>
                            <option value="New" selected>New</option>
                            <option value="Contacted">Contacted</option>
                            <option value="Proposal Sent">Proposal Sent</option>

                        </select>
                    </div>
                </div>
<!--                                    <div class="col-md-3">-->
<!--                                        <div class="form-group">-->
<!--                                            <label>Website</label>-->
<!--                                            <input type="text" class="form-control" name="website" id="website"-->
<!--                                                placeholder="Website">-->
<!--                                        </div>-->
<!--                                    </div>-->

                <div class="col-md-3">
                    <div class="form-group">
                        <label>Source</label>
                            <select class="form-control " name="source" id="source">
                            <option value="" disabled selected hidden>Select</option>
                            <option value="Web">Web</option>
                            <option value="Email">Email</option>
                            <option value="Phone">Phone</option>
                            <option value="Social_Media">Social Media</option>

                        </select>
                    </div>
                </div>

                <!-- <div class="col-md-3">
                    <div class="form-group">
                        <label>Old</label>
                        <imput type="text" name="old" id="old" class="form-control"
                            placeholder="Old" required></imput>
                    </div>
                </div> -->
                <div class="col-md-3">
                    <div class="form-group">
                        <label>Inquiry Reference Number</label>
                        <input type="text" name="refer" id="refer" class="form-control"
                            placeholder="Enter Inquiry Reference Number">
                    </div>
                </div>

                <div class="col-md-3">
                    <div class="form-group">
                        <label>GST No</label>
                        <input type="text" name="gst_no" onkeyup="validateGst(this)" id="gst_no" class="form-control"
                            placeholder="gst_no">
                    </div>
        <span id="gstNoError" style="color: red;"></span>
                </div>


                <div class="col-md-3">
                    <div class="form-group">
                        <label>Inquiry</label>
                        <textarea type="text" name="inquiry" id="inquiry" class="form-control"
                            placeholder="Inquiry"></textarea>
                    </div>
                </div>

            </div>
            <div class="add-customer-btns text-end">
                <button type="submit" class="btn btn-outline-primary me-1 btn-rounded">Save
                    Leads</button>
                <button class="btn customer-btn-cancel btn-outline-danger me-1 btn-rounded">Cancel
                <button type="reset"
                    class="btn btn-outline-secondary me-1 btn-rounded">Reset</button>

            </div>
            <div class="row col-sm-6 p-5">
                <div class="success_message row"></div>
            </div>
        
    </div>
</div>
</div>
</div>
</form>
</div>
</div>


{% endblock main_content %}

{% block custom_js %}
<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<script>


function validateEmail(emailField) {
var reg = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
const emailError = document.getElementById("msg_email");

if (reg.test(emailField.value)) {
console.log('ddd');
emailError.textContent = ''
return true;

}
const allowedValues = ['na', 'NA', 'nan', 'NaN'];
if (allowedValues.includes(emailField.value)) {
console.log('dddsss');
emailError.textContent = ''
return true;
}
console.log('ddaaaad');
emailField.value = ''
emailError.textContent = "please enter valid email or 'na'"
return false;
}

function validateGst(input) {
    const gstNoRegex = /^([0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}[Z]{1}[0-9A-Z]{1})$/;
    const gst_no = input.value;
    const isValid = gstNoRegex.test(gst_no);
    
    const errorSpan = document.getElementById('gstNoError');
    if (!isValid) {
        errorSpan.textContent = "Invalid GST No";
    } else {
        errorSpan.textContent = "";
    }
    return isValid;
}


// function validateForm(event) {
//     const gstInput = document.getElementById('gst_no');
//     if (!validateGst(gstInput)) {
//         // event.preventDefault(); // Prevent form submission
//         return false; // Prevent form submission
//     }
//     return true; // Allow form submission
// }

</script>

{% endblock custom_js %}