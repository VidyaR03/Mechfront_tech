
{% extends 'dashboard/base_template.html' %}
    {% block custom_css %}
        {% block page_title %}
        {% endblock page_title %}
        <style>
            .custom-error {
                max-width: 300px;
                /* Adjust the width to your desired value */
                margin: 0 auto;
                /* Add this line to center the element */
                text-align: center;
                /* Add this line to center the text inside the element */
              }
              .input-group-text {
                cursor: pointer;
              }
              .grey-card {
                background-color:LightGray;
            }
            .negative-padding {
              margin-top: -60px; 
          }
         
    
       
          

        </style>
    {% endblock custom_css %}
    <!-- Main content -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.0/html2pdf.bundle.min.js"></script>
    <style>
      .right-aligned {
          position: fixed;
          top: 20px; /* Adjust the top position as needed */
          right: 20px; /* Adjust the right position as needed */
      }
  </style>
{% block main_content %}
<div class="page-wrapper" style="min-height: 341px;">

    <div class="content container-fluid">
       
       <div class="row">
          <div class="col-sm-12">
             <div class="card card-table">
                <div class="card-header">
                   <!-- <div class="col-lg-12">
                      <div class="row">
                         <div class="col-lg-8">
                            <h3>
                            <a href="{% url 'purchase_register_report_date' %}" style="margin-right: 10px;">
                                <i class="fa fa-arrow-left" data-bs-toggle="tooltip" title="" data-bs-original-title="Back" aria-label="fa fa-arrow-left"></i>
                            </a>    
                           Purchase Register Report</h3>   
                        <form method="post" action="{% url 'download_excel' %}">
                            {% csrf_token %}
                            <input type="hidden" name="start_date" value="{{ start_date }}">
                            <input type="hidden" name="end_date" value="{{ end_date }}">
                            <button type="submit" class="btn btn-primary">Download Excel</button>
                        </form>
                        
                        
                        </div>

                        </div>
                         
                      </div> -->
                    <div class="col-lg-12">
                        <div class="d-flex justify-content-between align-items-center">
                            <h3 class="mb-0">
                                <a href="{% url 'purchase_register_report_date' %}" style="margin-right: 10px;">
                                    <i class="fa fa-arrow-left" data-bs-toggle="tooltip" title="Back" aria-label="fa fa-arrow-left"></i>
                                </a>
                                Purchase Register Report
                            </h3>
                            <form method="post" action="{% url 'download_excel' %}" class="mb-0">
                                {% csrf_token %}
                                <input type="hidden" name="start_date" value="{{ start_date }}">
                                <input type="hidden" name="end_date" value="{{ end_date }}">
                                <button type="submit" class="btn btn-primary">Download Excel</button>
                            </form>
                        </div>
                    </div>
                    
                </div>

                <!-- Debug prints -->
            
            <!-- Provide option to download data in Excel format -->
            <!-- <form method="post" action="{% url 'download_excel' %}">
                {% csrf_token %}
                <input type="hidden" name="start_date" value="{{ start_date }}">
                <input type="hidden" name="end_date" value="{{ end_date }}">
                <button type="submit" class="btn btn-primary">Download Excel</button>
            </form> -->

              <div id="printableArea">

                <div class="card-body" id="customer_ledger_pdf">
                   <div class="rport">
                    <h2><b>M/S KEYMECH TECHNOLOGIES </b>
                    </h2>
                    <p style="font-size: 20px;">Purchase Register Report</p> 
                    <p>     
                   <b> From </b>&nbsp;{{ start_date }} &nbsp; <b>To</b> &nbsp; {{ end_date }}
                    
                    <br>
                    </div>
                    <br>
     
 <table class="table table-center">
  <thead class="thead-dark">
      <tr>
          <th>SR.NO.</th>
          <th>VENDOR NAME</th>
          <th>INVOICE NO.</th>
          <th>INVOICE DATE</th>
          <th>AMOUNT</th>
          <th>P&F</th>
          <th>CGST</th>
          <th>SGST</th>
          <th>IGST</th>
          <th>TOTAL</th>
      </tr>
  </thead>
  <tbody>
      {% for item in purchase_items_within_range %}
      <tr>
          <td>{{ forloop.counter }}</td> 

          <!-- <td><a href="{% url 'purchase_register_detail' item.id %}" style="color: blue;">{{ item.purchase_invoice_vendor_name.contact_person|upper }}</a></td> -->
          <td>{{ item.purchase_invoice_vendor_name.contact_person|upper }}</td>

          <td>{{ item.purchase_invoice_grn_no }}</td>
          <td>{{ item.purchase_invoice_date|date:"j F Y" }}</td>
          <td>{{ item.purchase_invoice_sub_total }}</td>
          <td>{{ item.purchase_freight_amount }}</td>
          <td>{{ item.purchase_invoice_cgstval }}</td>
          <td>{{ item.purchase_invoice_sgstval }}</td>
          <td>{{ item.purchase_invoice_igstval }}</td>
          <td>{{ item.purchase_invoice_total }}</td>
      </tr>
      {% endfor %}
      <tr>
          <td colspan="4"><strong>TOTAL</strong></td>
          <td><strong>{{ total_amount }}</strong></td>
          <td><strong>{{ total_freight }}</strong></td>
          <td><strong>{{ total_cgst }}</strong></td>
          <td><strong>{{ total_sgst }}</strong></td>
          <td><strong>{{ total_igst }}</strong></td>
          <td><strong>{{ total_invoice }}</strong></td>
      </tr>
  </tbody>
</table>

 <script>
  function printDiv(divId) {
     var printContents = document.getElementById(divId).innerHTML;
     var originalContents = document.body.innerHTML;

     document.body.innerHTML = printContents;

     window.print();

     document.body.innerHTML = originalContents;
}

</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        let today = new Date().toISOString().split('T')[0];
        document.getElementById("from_date").value = today;
        document.getElementById("to_date").value = today;
    });
</script>
{% endblock main_content %}





